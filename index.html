<!doctype html>
<html lang="id">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <link rel="stylesheet" href="css/leaflet.css">
        <link rel="stylesheet" href="css/L.Control.Layers.Tree.css">
        <link rel="stylesheet" href="css/qgis2web.css">
        <link rel="stylesheet" href="css/fontawesome-all.min.css">
        <link rel="stylesheet" href="css/leaflet.photon.css">
        
        <!-- Google Fonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
        
        <style>
/* ========== RESET DASAR ========== */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Inter', 'Segoe UI', Arial, sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: #111827;
    overflow: hidden;
    position: relative;
}

body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.03);
    z-index: -1;
}

html, body {
    width: 100%;
    height: 100%;
    padding: 0;
    margin: 0;
}

/* ========== HEADER ========== */
.header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: 70px;
    background: rgba(255, 255, 255, 0.98);
    backdrop-filter: blur(15px);
    color: #111827;
    padding: 0 30px;
    z-index: 1001;
    box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.08);
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.header-left {
    display: flex;
    align-items: center;
    gap: 15px;
}

.logo {
    width: 45px;
    height: 45px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 20px;
    font-weight: 600;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
}

.title-container h1 {
    font-size: 22px;
    font-weight: 700;
    color: #111827;
    margin-bottom: 3px;
    letter-spacing: -0.3px;
}

.title-container p {
    font-size: 13px;
    color: #6b7280;
    font-weight: 400;
}

.header-right {
    display: flex;
    gap: 10px;
}

.header-btn {
    background: white;
    border: 1.5px solid #e5e7eb;
    border-radius: 10px;
    padding: 10px 20px;
    color: #374151;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 14px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.header-btn:hover {
    background: #f9fafb;
    border-color: #667eea;
    color: #667eea;
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.15);
}

.header-btn i {
    font-size: 15px;
}

/* ========== SIDEBAR ========== */
.sidebar {
    position: fixed;
    top: 70px;
    left: 0;
    width: 320px;
    bottom: 50px;
    background: rgba(255, 255, 255, 0.98);
    backdrop-filter: blur(15px);
    border-right: 1px solid rgba(0, 0, 0, 0.08);
    padding: 25px;
    overflow-y: auto;
    z-index: 1000;
    box-shadow: 5px 0 30px rgba(0, 0, 0, 0.05);
}

.sidebar::-webkit-scrollbar {
    width: 6px;
}

.sidebar::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.02);
    border-radius: 3px;
}

.sidebar::-webkit-scrollbar-thumb {
    background: rgba(102, 126, 234, 0.3);
    border-radius: 3px;
}

.sidebar::-webkit-scrollbar-thumb:hover {
    background: rgba(102, 126, 234, 0.5);
}

/* ========== MAP CONTAINER ========== */
.map-container {
    position: fixed;
    top: 70px;
    left: 320px;
    right: 0;
    bottom: 50px;
    transition: left 0.3s ease;
    z-index: 1;
}

#map {
    width: 100%;
    height: 100%;
    border-radius: 0;
}

/* ========== CARDS ========== */
.card {
    background: rgba(255, 255, 255, 0.9);
    border-radius: 16px;
    padding: 22px;
    margin-bottom: 22px;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.07);
    border: 1px solid rgba(255, 255, 255, 0.3);
    backdrop-filter: blur(5px);
    transition: all 0.3s ease;
}

.card:hover {
    box-shadow: 0 12px 30px rgba(0, 0, 0, 0.1);
    transform: translateY(-2px);
}

.card h3 {
    font-size: 16px;
    font-weight: 700;
    margin-bottom: 15px;
    color: #111827;
    display: flex;
    align-items: center;
    gap: 10px;
}

.card h3 i {
    color: #667eea;
}

.card p {
    font-size: 14px;
    color: #4b5563;
    line-height: 1.6;
    margin-bottom: 15px;
}

/* ========== LEGENDA ========== */
.legend {
    margin-top: 10px;
}

.legend-item {
    display: flex;
    align-items: center;
    font-size: 14px;
    margin-bottom: 12px;
    color: #374151;
    padding: 8px;
    border-radius: 10px;
    transition: background 0.3s ease;
}

.legend-item:hover {
    background: rgba(102, 126, 234, 0.05);
}

.color-box {
    width: 20px;
    height: 20px;
    border-radius: 6px;
    margin-right: 12px;
    border: 2px solid rgba(255, 255, 255, 0.8);
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

/* ========== FOOTER ========== */
.footer {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    height: 50px;
    background: rgba(255, 255, 255, 0.98);
    backdrop-filter: blur(15px);
    border-top: 1px solid rgba(0, 0, 0, 0.08);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 30px;
    z-index: 1000;
    box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.05);
}

.footer-left {
    display: flex;
    align-items: center;
    gap: 20px;
    font-size: 13px;
    color: #6b7280;
}

.footer-right {
    display: flex;
    align-items: center;
    gap: 15px;
    font-size: 13px;
    color: #6b7280;
}

.footer-icon {
    color: #667eea;
    text-decoration: none;
    display: flex;
    align-items: center;
    gap: 5px;
    transition: color 0.3s ease;
}

.footer-icon:hover {
    color: #764ba2;
}

/* ========== STATS ========== */
.stats {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 15px;
    margin-top: 15px;
}

.stat-item {
    background: rgba(102, 126, 234, 0.08);
    border-radius: 12px;
    padding: 15px;
    text-align: center;
    border: 1px solid rgba(102, 126, 234, 0.15);
}

.stat-value {
    font-size: 20px;
    font-weight: 700;
    color: #667eea;
    margin-bottom: 5px;
}

.stat-label {
    font-size: 12px;
    color: #6b7280;
    font-weight: 500;
}

/* ========== TOGGLE BUTTON ========== */
.toggle-sidebar {
    position: fixed;
    top: 85px;
    left: 305px;
    width: 30px;
    height: 30px;
    background: white;
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    z-index: 1002;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
}

.toggle-sidebar:hover {
    background: #f9fafb;
    border-color: #667eea;
    transform: translateX(-2px);
}

/* ========== RESPONSIVE ========== */
@media (max-width: 1024px) {
    .sidebar {
        width: 280px;
        padding: 20px;
    }
    
    .map-container {
        left: 280px;
    }
    
    .toggle-sidebar {
        left: 265px;
    }
}

@media (max-width: 768px) {
    .sidebar {
        transform: translateX(-100%);
        width: 300px;
    }
    
    .sidebar.active {
        transform: translateX(0);
    }
    
    .map-container {
        left: 0;
    }
    
    .header {
        padding: 0 15px;
    }
    
    .header-btn span {
        display: none;
    }
    
    .header-btn {
        padding: 10px;
    }
    
    .toggle-sidebar {
        left: 15px;
        top: 80px;
    }
    
    .footer {
        padding: 0 15px;
        flex-direction: column;
        height: auto;
        padding: 10px;
        gap: 10px;
    }
    
    .footer-left, .footer-right {
        width: 100%;
        justify-content: center;
        text-align: center;
    }
}

/* ========== CUSTOM LEAFLET ========== */
.leaflet-control-zoom {
    margin-top: 80px !important;
    margin-left: 20px !important;
    border-radius: 12px !important;
    overflow: hidden;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15) !important;
    border: none !important;
}

.leaflet-control-zoom a {
    background: white !important;
    border: none !important;
    color: #374151 !important;
    transition: all 0.3s ease !important;
    width: 45px !important;
    height: 45px !important;
    line-height: 45px !important;
    font-size: 18px !important;
}

.leaflet-control-zoom a:hover {
    background: #f8f9fa !important;
    color: #667eea !important;
}

.leaflet-popup-content-wrapper {
    border-radius: 12px !important;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15) !important;
    border: none !important;
    backdrop-filter: blur(10px);
    background: rgba(255, 255, 255, 0.95) !important;
}

.leaflet-popup-content {
    font-size: 14px !important;
    color: #374151 !important;
}
        </style>
        <title>WebGIS - Persebaran Jenis Tanah Samarinda</title>
    </head>
    <body>
        <!-- HEADER -->
        <div class="header">
            <div class="header-left">
                <div class="logo">
                    <i class="fas fa-map-marked-alt"></i>
                </div>
                <div class="title-container">
                    <h1>WebGIS Jenis Tanah Samarinda</h1>
                    <p>Peta Persebaran Jenis Tanah di Wilayah Samarinda</p>
                </div>
            </div>
            <div class="header-right">
                <button class="header-btn" onclick="toggleFullscreen()">
                    <i class="fas fa-expand"></i>
                    <span>Fullscreen</span>
                </button>
                <button class="header-btn" onclick="printMap()">
                    <i class="fas fa-print"></i>
                    <span>Cetak</span>
                </button>
                <button class="header-btn" onclick="showInfo()">
                    <i class="fas fa-info-circle"></i>
                    <span>Info</span>
                </button>
            </div>
        </div>

        <!-- SIDEBAR TOGGLE -->
        <div class="toggle-sidebar" onclick="toggleSidebar()">
            <i class="fas fa-bars"></i>
        </div>

        <!-- SIDEBAR -->
        <div class="sidebar" id="sidebar">
            <div class="card">
                <h3><i class="fas fa-info-circle"></i> Informasi Peta</h3>
                <p>
                    WebGIS ini menampilkan persebaran jenis tanah di wilayah Samarinda berdasarkan klasifikasi FAO.
                    Data mencakup jenis tanah, luas area, dan karakteristik masing-masing zona.
                </p>
                <p style="font-size: 13px; color: #667eea; font-weight: 500;">
                    <i class="fas fa-map-marker-alt"></i> Lokasi: Samarinda, Kalimantan Timur
                </p>
            </div>

            <div class="card">
                <h3><i class="fas fa-layer-group"></i> Statistik Data</h3>
                <div class="stats">
                    <div class="stat-item">
                        <div class="stat-value" id="statWilayah">3</div>
                        <div class="stat-label">Jenis Tanah</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="statArea">-</div>
                        <div class="stat-label">Luas Total</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3><i class="fas fa-palette"></i> Legenda Tanah</h3>
                <div class="legend">
                    <div class="legend-item">
                        <div class="color-box" style="background: rgba(64,237,202,1.0);"></div>
                        <span>Tanah Aluvial</span>
                    </div>
                    <div class="legend-item">
                        <div class="color-box" style="background: rgba(177,202,123,1.0);"></div>
                        <span>Tanah Latosol</span>
                    </div>
                    <div class="legend-item">
                        <div class="color-box" style="background: rgba(219,21,61,1.0);"></div>
                        <span>Tanah Organosol</span>
                    </div>
                    <div class="legend-item">
                        <div class="color-box" style="background: rgba(117,67,233,1.0);"></div>
                        <span>Jenis Lain</span>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3><i class="fas fa-map"></i> Kontrol Peta</h3>
                <p style="margin-bottom: 10px;">
                    <i class="fas fa-mouse-pointer"></i> Klik area untuk melihat detail
                </p>
                <p style="margin-bottom: 10px;">
                    <i class="fas fa-search-plus"></i> Scroll untuk zoom in/out
                </p>
                <p>
                    <i class="fas fa-hand-paper"></i> Drag untuk berpindah peta
                </p>
            </div>
        </div>

        <!-- MAP CONTAINER -->
        <div class="map-container">
            <div id="map"></div>
        </div>

        <!-- FOOTER -->
        <div class="footer">
            <div class="footer-left">
                <div>© 2024 WebGIS Samarinda</div>
                <div>•</div>
                <div>Data Sumber: FAO Soil Classification</div>
            </div>
            <div class="footer-right">
                <a href="#" class="footer-icon" onclick="showAbout()">
                    <i class="fas fa-user"></i>
                    <span>Fatur Raflin</span>
                </a>
                <div>•</div>
                <div>Koordinat: <span id="coords">Loading...</span></div>
                <div>•</div>
                <div>Zoom: <span id="zoomLevel">1</span></div>
            </div>
        </div>

        <!-- SEMUA SCRIPT ASLI TANPA PERUBAHAN -->
        <script src="js/qgis2web_expressions.js"></script>
        <script src="js/leaflet.js"></script>
        <script src="js/L.Control.Layers.Tree.min.js"></script>
        <script src="js/leaflet.rotatedMarker.js"></script>
        <script src="js/leaflet.pattern.js"></script>
        <script src="js/leaflet-hash.js"></script>
        <script src="js/Autolinker.min.js"></script>
        <script src="js/rbush.min.js"></script>
        <script src="js/labelgun.min.js"></script>
        <script src="js/labels.js"></script>
        <script src="js/leaflet.photon.js"></script>
        <script src="data/Refactored_1.js"></script>
        
        <script>
        // ========== FUNGSI UI BARU ==========
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const mapContainer = document.querySelector('.map-container');
            const toggleBtn = document.querySelector('.toggle-sidebar i');
            
            sidebar.classList.toggle('active');
            
            if (sidebar.classList.contains('active')) {
                mapContainer.style.left = '0';
                toggleBtn.className = 'fas fa-chevron-right';
            } else {
                mapContainer.style.left = '320px';
                toggleBtn.className = 'fas fa-bars';
            }
        }

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => {
                    console.log(`Error attempting to enable fullscreen: ${err.message}`);
                });
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                }
            }
        }

        function printMap() {
            alert('Fitur cetak akan membuka peta dalam format PDF/Image.\n(Silahkan implementasi sesuai kebutuhan)');
        }

        function showInfo() {
            const info = `WEBGIS JENIS TANAH SAMARINDA

• Menampilkan persebaran 3 jenis tanah utama
• Data berdasarkan klasifikasi FAO
• Fitur interaktif dengan popup detail
• Peta satelit ESRI World Imagery

Koordinat: -0.5° LS, 117° BT
Skala: 1:50.000`;
            
            alert(info);
        }

        function showAbout() {
            alert('Dikembangkan oleh:\nFatur Raflin\n\nUntuk keperluan pemetaan digital\ndan analisis spasial jenis tanah.');
        }

        // Update footer dengan info peta
        function updateMapInfo() {
            const coords = map.getCenter();
            document.getElementById('coords').textContent = 
                `${coords.lat.toFixed(4)}°, ${coords.lng.toFixed(4)}°`;
            document.getElementById('zoomLevel').textContent = map.getZoom();
            
            // Update statistik
            const areas = ['Tanah Aluvial', 'Tanah Latosol', 'Tanah Organosol'];
            document.getElementById('statWilayah').textContent = areas.length;
        }

        // ========== KODE ASLI PETA (TIDAK DIUBAH) ==========
        var map = L.map('map', {
            zoomControl:false, maxZoom:28, minZoom:1
        }).fitBounds([[-0.7962249666756842,116.80959030478847],[-0.2803535783772635,117.52760792529934]]);
        var hash = new L.Hash(map);
        map.attributionControl.setPrefix('<a href="https://github.com/tomchadwin/qgis2web" target="_blank">qgis2web</a> &middot; <a href="https://leafletjs.com" title="A JS library for interactive maps">Leaflet</a> &middot; <a href="https://qgis.org">QGIS</a>');
        var autolinker = new Autolinker({truncate: {length: 30, location: 'smart'}});
        
        // remove popup's row if "visible-with-data"
        function removeEmptyRowsFromPopupContent(content, feature) {
         var tempDiv = document.createElement('div');
         tempDiv.innerHTML = content;
         var rows = tempDiv.querySelectorAll('tr');
         for (var i = 0; i < rows.length; i++) {
             var td = rows[i].querySelector('td.visible-with-data');
             var key = td ? td.id : '';
             if (td && td.classList.contains('visible-with-data') && feature.properties[key] == null) {
                 rows[i].parentNode.removeChild(rows[i]);
             }
         }
         return tempDiv.innerHTML;
        }
        
        // modify popup if contains media
        function addClassToPopupIfMedia(content, popup) {
            var tempDiv = document.createElement('div');
            tempDiv.innerHTML = content;
            var imgTd = tempDiv.querySelector('td img');
            if (imgTd) {
                var src = imgTd.getAttribute('src');
                if (/\.(jpg|jpeg|png|gif|bmp|webp|avif)$/i.test(src)) {
                    popup._contentNode.classList.add('media');
                    setTimeout(function() {
                        popup.update();
                    }, 10);
                } else if (/\.(mp3|wav|ogg|aac)$/i.test(src)) {
                    var audio = document.createElement('audio');
                    audio.controls = true;
                    audio.src = src;
                    imgTd.parentNode.replaceChild(audio, imgTd);
                    popup._contentNode.classList.add('media');
                    setTimeout(function() {
                        popup.setContent(tempDiv.innerHTML);
                        popup.update();
                    }, 10);
                } else if (/\.(mp4|webm|ogg|mov)$/i.test(src)) {
                    var video = document.createElement('video');
                    video.controls = true;
                    video.src = src;
                    video.style.width = "400px";
                    video.style.height = "300px";
                    video.style.maxHeight = "60vh";
                    video.style.maxWidth = "60vw";
                    imgTd.parentNode.replaceChild(video, imgTd);
                    popup._contentNode.classList.add('media');
                    video.addEventListener('loadedmetadata', function() {
                        popup.update();
                    });
                    setTimeout(function() {
                        popup.setContent(tempDiv.innerHTML);
                        popup.update();
                    }, 10);
                } else {
                    popup._contentNode.classList.remove('media');
                }
            } else {
                popup._contentNode.classList.remove('media');
            }
        }
        
        var zoomControl = L.control.zoom({
            position: 'topleft'
        }).addTo(map);
        
        var bounds_group = new L.featureGroup([]);
        function setBounds() {
        }
        
        map.createPane('pane_ESRI_0');
        map.getPane('pane_ESRI_0').style.zIndex = 400;
        var layer_ESRI_0 = L.tileLayer('https://server.arcgisonline.com/arcgis/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
            pane: 'pane_ESRI_0',
            opacity: 1.0,
            attribution: '',
            minZoom: 1,
            maxZoom: 28,
            minNativeZoom: 0,
            maxNativeZoom: 19
        });
        layer_ESRI_0;
        map.addLayer(layer_ESRI_0);
        
        function pop_Refactored_1(feature, layer) {
            var popupContent = '<table>\
                    <tr>\
                        <th scope="row">Nama Wilayah</th>\
                        <td class="visible-with-data" id="Nama Wilayah">' + (feature.properties['Nama Wilayah'] !== null ? autolinker.link(String(feature.properties['Nama Wilayah']).replace(/'/g, '\'').toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">Kabupaten / Kota</th>\
                        <td class="visible-with-data" id="Kabupaten / Kota">' + (feature.properties['Kabupaten / Kota'] !== null ? autolinker.link(String(feature.properties['Kabupaten / Kota']).replace(/'/g, '\'').toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">Provinsi</th>\
                        <td class="visible-with-data" id="Provinsi">' + (feature.properties['Provinsi'] !== null ? autolinker.link(String(feature.properties['Provinsi']).replace(/'/g, '\'').toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">Kode Tanah FAO</th>\
                        <td class="visible-with-data" id="Kode Tanah FAO">' + (feature.properties['Kode Tanah FAO'] !== null ? autolinker.link(String(feature.properties['Kode Tanah FAO']).replace(/'/g, '\'').toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">Jenis Tanah (Kode)</th>\
                        <td class="visible-with-data" id="Jenis Tanah (Kode)">' + (feature.properties['Jenis Tanah (Kode)'] !== null ? autolinker.link(String(feature.properties['Jenis Tanah (Kode)']).replace(/'/g, '\'').toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">Nama Jenis Tanah</th>\
                        <td class="visible-with-data" id="Nama Jenis Tanah">' + (feature.properties['Nama Jenis Tanah'] !== null ? autolinker.link(String(feature.properties['Nama Jenis Tanah']).replace(/'/g, '\'').toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">Luas Area (km2)</th>\
                        <td class="visible-with-data" id="Luas Area (km2)">' + (feature.properties['Luas Area (km2)'] !== null ? autolinker.link(String(feature.properties['Luas Area (km2)']).replace(/'/g, '\'').toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">Keterangan Tanah</th>\
                        <td class="visible-with-data" id="Keterangan Tanah">' + (feature.properties['Keterangan Tanah'] !== null ? autolinker.link(String(feature.properties['Keterangan Tanah']).replace(/'/g, '\'').toLocaleString()) : '') + '</td>\
                    </tr>\
                </table>';
            var content = removeEmptyRowsFromPopupContent(popupContent, feature);
			layer.on('popupopen', function(e) {
				addClassToPopupIfMedia(content, e.popup);
			});
			layer.bindPopup(content, { maxHeight: 400 });
        }

        function style_Refactored_1_0(feature) {
            switch(String(feature.properties['Nama Jenis Tanah'])) {
                case 'Tanah Aluvial':
                    return {
                pane: 'pane_Refactored_1',
                opacity: 1,
                color: 'rgba(35,35,35,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(64,237,202,1.0)',
                interactive: true,
            }
                    break;
                case 'Tanah Latosol':
                    return {
                pane: 'pane_Refactored_1',
                opacity: 1,
                color: 'rgba(35,35,35,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(177,202,123,1.0)',
                interactive: true,
            }
                    break;
                case 'Tanah Organosol':
                    return {
                pane: 'pane_Refactored_1',
                opacity: 1,
                color: 'rgba(35,35,35,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(219,21,61,1.0)',
                interactive: true,
            }
                    break;
                default:
                    return {
                pane: 'pane_Refactored_1',
                opacity: 1,
                color: 'rgba(35,35,35,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(117,67,233,1.0)',
                interactive: true,
            }
                    break;
            }
        }
        
        map.createPane('pane_Refactored_1');
        map.getPane('pane_Refactored_1').style.zIndex = 401;
        map.getPane('pane_Refactored_1').style['mix-blend-mode'] = 'normal';
        var layer_Refactored_1 = new L.geoJson(json_Refactored_1, {
            attribution: '',
            interactive: true,
            dataVar: 'json_Refactored_1',
            layerName: 'layer_Refactored_1',
            pane: 'pane_Refactored_1',
            onEachFeature: pop_Refactored_1,
            style: style_Refactored_1_0,
        });
        bounds_group.addLayer(layer_Refactored_1);
        map.addLayer(layer_Refactored_1);
        setBounds();
        var i = 0;
        layer_Refactored_1.eachLayer(function(layer) {
            var context = {
                feature: layer.feature,
                variables: {}
            };
            layer.bindTooltip((layer.feature.properties['Nama Jenis Tanah'] !== null?String('<div style="color: #f7fbff; font-size: 10pt; font-family: \'Segoe UI Semibold\', sans-serif;">' + layer.feature.properties['Nama Jenis Tanah']) + '</div>':''), {permanent: true, offset: [-0, -16], className: 'css_Refactored_1'});
            labels.push(layer);
            totalMarkers += 1;
              layer.added = true;
              addLabel(layer, i);
              i++;
        });
        resetLabels([layer_Refactored_1]);
        map.on("zoomend", function(){
            resetLabels([layer_Refactored_1]);
            updateMapInfo(); // Update info saat zoom
        });
        map.on("layeradd", function(){
            resetLabels([layer_Refactored_1]);
        });
        map.on("layerremove", function(){
            resetLabels([layer_Refactored_1]);
        });
        map.on("moveend", function(){
            updateMapInfo(); // Update info saat peta bergerak
        });
        
        // Inisialisasi info peta
        document.addEventListener('DOMContentLoaded', function() {
            updateMapInfo();
            
            // Hitung total luas area dari data
            let totalLuas = 0;
            if (json_Refactored_1 && json_Refactored_1.features) {
                json_Refactored_1.features.forEach(feature => {
                    const luas = feature.properties['Luas Area (km2)'];
                    if (luas && !isNaN(luas)) {
                        totalLuas += parseFloat(luas);
                    }
                });
                document.getElementById('statArea').textContent = totalLuas.toFixed(1) + ' km²';
            }
        });
        </script>
    </body>
</html>